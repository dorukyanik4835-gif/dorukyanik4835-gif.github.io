<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gaz & Temizlik Takip</title>

<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: url("bg.jpg") no-repeat center center;
    background-size: 1024px 1024px;
    background-color: #f2f2f2;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    background: rgba(255,255,255,0.95);
    padding: 25px;
    border-radius: 15px;
    width: 380px;
    text-align: center;
    box-shadow: 0 0 20px rgba(0,0,0,0.25);
}

h1 { color: #2d89ef; margin-top: 0; }

.sensor {
    font-size: 22px;
    font-weight: bold;
    margin: 15px 0;
}

.button {
    width: 100%;
    padding: 10px;
    margin: 6px 0;
    border: none;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
    background-color: #2d89ef;
    color: white;
}

.button:hover {
    background-color: #1b5fa7;
}

.kayit {
    margin-top: 15px;
    font-size: 13px;
    text-align: left;
    max-height: 140px;
    overflow-y: auto;
    border-top: 1px solid #ccc;
    padding-top: 8px;
}
</style>
</head>

<body>

<div class="container">

    <h1>ðŸ§¼ Gaz & Temizlik Takip</h1>

    <!-- CANLI SENSÃ–R DEÄžERÄ° -->
    <div class="sensor">
        Gaz DeÄŸeri: <span id="gaz">BaÄŸlÄ± DeÄŸil</span>
    </div>

    <!-- ARDUINO BAÄžLANTI BUTONU -->
    <button class="button" onclick="baglan()">Arduino BaÄŸlan</button>

    <!-- SON TEMÄ°ZLÄ°K ZAMANI -->
    <p><strong>Son Temizlik ZamanÄ±:</strong></p>
    <p id="temizlikZamani">HenÃ¼z temizlik yapÄ±lmadÄ±</p>

    <!-- TEMÄ°ZLÄ°K ÃœRÃœNLERÄ° -->
    <p><strong>ÃœrÃ¼n SeÃ§:</strong></p>
    <button class="button" onclick="kaydet('Domestos')">Domestos</button>
    <button class="button" onclick="kaydet('Cif')">Cif</button>
    <button class="button" onclick="kaydet('Mr. Muscle')">Mr. Muscle</button>
    <button class="button" onclick="kaydet('Bingo')">Bingo</button>

    <!-- TEMÄ°ZLÄ°K KAYIT LÄ°STESÄ° -->
    <div class="kayit">
        <strong>KayÄ±tlar:</strong>
        <div id="liste"></div>
    </div>

</div>

<script>
let port;
let reader;

/* ARDUINO BAÄžLANTI FONKSÄ°YONU */
async function baglan() {
    try {
        port = await navigator.serial.requestPort();
        await port.open({ baudRate: 9600 });

        const decoder = new TextDecoderStream();
        port.readable.pipeTo(decoder.writable);
        reader = decoder.readable.getReader();

        document.getElementById("gaz").innerText = "BaÄŸlandÄ±, veri bekleniyor...";

        while (true) {
            const { value, done } = await reader.read();
            if (done) break;
            if (value) {
                document.getElementById("gaz").innerText = value.trim();
            }
        }

    } catch (e) {
        alert("Arduino baÄŸlantÄ±sÄ± iptal edildi veya hata oluÅŸtu.");
    }
}

/* TEMÄ°ZLÄ°K KAYDI FONKSÄ°YONU */
function kaydet(marka) {
    const now = new Date().toLocaleString("tr-TR");
    document.getElementById("temizlikZamani").innerText = now;

    const yeni = document.createElement("div");
    yeni.innerText = now + " - " + marka + " ile temizlendi";
    document.getElementById("liste").prepend(yeni);
}
</script>

</body>
</html>
